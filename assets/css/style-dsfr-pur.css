/* =======================================================================
   MARKDOWN EDITOR DSFR - STYLE 100% DSFR
   Utilise UNIQUEMENT les variables et classes DSFR
   Bleu marine officiel : #000091 (comme le drapeau français)
   ======================================================================= */

/* --- VARIABLES CUSTOM MINIMALES --- */
:root {
  --blue-marine: #000091; /* Bleu marine du drapeau français */
  --blue-marine-hover: #1212ff;
  --blue-marine-active: #2323ff;
}

/* --- CONTENEUR CENTRÉ --- */
.fr-container {
  max-width: 1200px !important;
  margin-left: auto !important;
  margin-right: auto !important;
  padding-left: 5rem !important;
  padding-right: 5rem !important;
}

main {
  padding-top: 2rem !important;
  padding-bottom: 2rem !important;
}

/* --- TOOLBAR STYLE WORD AVEC ONGLETS BLEU MARINE --- */
.dsfr-toolbar {
  background: white;
  padding: 0;
  border-radius: 0;
  margin-bottom: 0;
  border: none;
  border-bottom: 2px solid var(--blue-marine);
}

/* Barre d'onglets (comme Word) - Compatible thème DSFR */
.toolbar-tabs {
  display: flex;
  gap: 0;
  background: var(--blue-marine);
  padding: 0;
  align-items: center;
}

/* Thème sombre pour la barre d'onglets */
[data-fr-scheme="dark"] .toolbar-tabs {
  background: var(--blue-marine);
  border-bottom: 1px solid var(--border-default-grey);
}

.toolbar-tab,
.toolbar-tab.fr-btn,
.toolbar-tab.fr-btn--sm {
  background: transparent !important;
  color: white !important;
  border: none !important;
  border-top: none !important;
  border-left: none !important;
  border-right: none !important;
  border-bottom: 3px solid transparent !important;
  padding: 0.5rem 1.5rem !important;
  cursor: pointer;
  font-size: 0.875rem !important;
  font-weight: 500 !important;
  transition: all 0.2s;
  border-radius: 0 !important;
  box-shadow: none !important;
  outline: none !important;
}

.toolbar-tab:hover,
.toolbar-tab.fr-btn:hover,
.toolbar-tab.fr-btn--sm:hover {
  background: rgba(255, 255, 255, 0.1) !important;
  color: white !important;
  border-bottom: 3px solid transparent !important;
}

.toolbar-tab.active,
.toolbar-tab.active.fr-btn,
.toolbar-tab.active.fr-btn--sm {
  background: white !important;
  color: var(--blue-marine) !important;
  border: none !important;
  border-top: none !important;
  border-left: none !important;
  border-right: none !important;
  border-bottom: 3px solid var(--blue-marine) !important;
}

/* Thème sombre pour les onglets */
[data-fr-scheme="dark"] .toolbar-tab.active,
[data-fr-scheme="dark"] .toolbar-tab.active.fr-btn,
[data-fr-scheme="dark"] .toolbar-tab.active.fr-btn--sm {
  background: var(--background-contrast-grey) !important;
  color: var(--text-title-grey) !important;
  border: none !important;
  border-top: none !important;
  border-left: none !important;
  border-right: none !important;
  border-bottom: 3px solid var(--text-title-grey) !important;
}

/* Bouton EXIT inline dans les onglets */
.exit-inline {
  margin-left: auto !important;
  background: rgba(255, 255, 255, 0.2) !important;
  color: white !important;
  border: 1px solid rgba(255, 255, 255, 0.4) !important;
  margin-right: 0.5rem !important;
}

.exit-inline:hover {
  background: rgba(255, 255, 255, 0.3) !important;
}

body.fullscreen-mode .exit-inline {
  display: block !important;
}

/* Barre Markdown fixe (toujours visible sous les onglets) */
.markdown-fixed-bar {
  background: var(--background-contrast-grey);
  padding: 0.5rem 1rem;
  border-bottom: 1px solid var(--border-default-grey);
  display: flex;
  gap: 0;
  flex-wrap: wrap;
  align-items: center;
}

.markdown-fixed-bar .toolbar-group {
  display: inline-flex;
  gap: 0.25rem;
  margin-right: 1.5rem;
  padding-right: 1.5rem;
  border-right: 1px solid var(--border-default-grey);
  align-items: center;
}

.markdown-fixed-bar .toolbar-group:last-child {
  border-right: none;
}

/* Icônes Bootstrap dans les boutons */
.markdown-fixed-bar .fr-btn i {
  font-size: 1.1rem;
}

/* Thème sombre pour la barre fixe */
[data-fr-scheme="dark"] .markdown-fixed-bar {
  background: var(--background-alt-grey);
  border-bottom-color: var(--border-default-grey);
}

/* Contenu de l'onglet */
.toolbar-content {
  padding: 0.75rem 1rem;
  background: white;
  min-height: 60px;
}

.toolbar-panel {
  display: none;
}

.toolbar-panel.active {
  display: block;
}

/* Groupes de boutons dans les panels */
.toolbar-group {
  display: inline-flex;
  gap: 0.5rem;
  margin-right: 1.5rem;
  padding-right: 1.5rem;
  border-right: 1px solid var(--border-default-grey);
  flex-wrap: wrap;
  align-items: center;
}

.toolbar-group:last-child {
  border-right: none;
}

/* Boutons dans les panels - style DSFR propre */
.toolbar-content .fr-btn {
  background: var(--blue-marine) !important;
  color: white !important;
  border: none !important;
  box-shadow: none !important;
}

.toolbar-content .fr-btn:hover {
  background: var(--blue-marine-hover) !important;
  transform: translateY(-1px);
}

/* Icônes dans les boutons */
.toolbar-content .fr-btn i,
.toolbar-panel .fr-btn i {
  font-size: 1.1rem;
}

.toolbar-group-label {
  display: none !important; /* Cacher les labels */
}

/* --- RANGÉES DE BOUTONS (supprimé, remplacé par onglets) --- */

/* --- BOUTONS BLEU MARINE (comme le drapeau) - COMPACTS --- */
.toolbar-btn {
  background: var(--blue-marine) !important;
  color: white !important;
  border: none !important;
  padding: 0.5rem 1rem !important; /* Réduit de 1rem à 0.5rem */
  border-radius: 0.25rem !important;
  font-size: 0.75rem !important; /* Réduit de 0.875rem à 0.75rem */
  font-weight: 600 !important;
  cursor: pointer !important;
  transition: all 0.2s !important;
  white-space: nowrap !important;
  flex: 1 !important;
  min-width: 150px !important; /* Réduit de 200px à 150px */
  text-align: left !important;
  display: flex !important;
  align-items: center !important;
  gap: 0.5rem !important;
}

.toolbar-btn:hover {
  background: var(--blue-marine-hover) !important;
  transform: translateY(-2px) !important;
  box-shadow: 0 4px 12px rgba(0, 0, 145, 0.3) !important;
}

.toolbar-btn:active,
.toolbar-btn.active {
  background: var(--blue-marine-active) !important;
  transform: translateY(0) !important;
}

/* --- DROPDOWNS --- */
.toolbar-dropdowns {
  margin-top: 1.5rem;
}

.toolbar-dropdown {
  background: white;
  border: 2px solid var(--blue-marine);
  border-radius: 0.25rem;
  padding: 1.5rem;
  margin-bottom: 1rem;
  box-shadow: 0 4px 12px rgba(0, 0, 145, 0.1);
}

.toolbar-dropdown.hidden {
  display: none;
}

.toolbar-dropdown:last-child {
  margin-bottom: 0;
}

/* --- GRILLE DE BOUTONS DANS LES DROPDOWNS --- */
.button-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 0.75rem;
}

.button-grid button {
  background: white;
  border: 2px solid var(--border-default-grey);
  padding: 0.875rem 1rem;
  border-radius: 0.25rem;
  cursor: pointer;
  text-align: left;
  font-size: 0.875rem;
  font-weight: 500;
  transition: all 0.2s;
  color: var(--text-default-grey);
}

.button-grid button:hover {
  background: var(--background-alt-blue-france);
  border-color: var(--blue-marine);
  transform: translateX(4px);
  box-shadow: 0 2px 8px rgba(0, 0, 145, 0.15);
}

/* --- ÉDITEUR ET PREVIEW --- */
.editor-container {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2rem;
  margin: 2rem auto; /* Centrer */
  max-width: 1400px; /* Largeur max */
  padding: 0 rem; /* Padding pour ne pas coller aux bords */
}

.editor-panel,
.preview-panel {
  background: white;
  border: 2px solid var(--border-default-grey);
  border-radius: 0.25rem;
  overflow: hidden;
}

.panel-header {
  background: var(--background-alt-grey);
  padding: 1rem 1.5rem;
  border-bottom: 2px solid var(--border-default-grey);
  font-weight: 700;
  font-size: 1rem;
  color: var(--text-title-grey);
}

#markdown-input {
  width: 100%;
  min-height: 600px;
  padding: 2rem;
  font-family: 'Courier New', Consolas, Monaco, monospace;
  font-size: 14px;
  line-height: 1.8;
  border: none;
  resize: vertical;
  background: white;
  color: var(--text-default-grey);
}

#markdown-input:focus {
  outline: 2px solid var(--blue-marine);
  outline-offset: -2px;
}

#preview {
  min-height: 600px;
  padding: 2rem;
  overflow-y: auto;
}

/* --- BARRE D'ACTIONS BLEU MARINE --- */
.action-bar {
  background: var(--background-action-low-blue-france);
  padding: 1.5rem;
  border-top: 2px solid var(--blue-marine);
  border-radius: 0 0 0.25rem 0.25rem;
  display: flex;
  justify-content: center;
  gap: 1rem;
  flex-wrap: wrap;
  margin: 2rem auto; /* Centrer */
  max-width: 1400px; /* Même largeur que l'éditeur */
}

.action-bar .fr-btn {
  min-width: 150px !important;
}

/* Surcharge des boutons DSFR pour le bleu marine */
.action-bar .fr-btn--secondary {
  background-color: var(--blue-marine) !important;
  color: white !important;
}

.action-bar .fr-btn--secondary:hover {
  background-color: var(--blue-marine-hover) !important;
}

/* --- NOTIFICATION --- */
.notification {
  position: fixed;
  bottom: 2rem;
  right: 2rem;
  padding: 1rem 1.5rem;
  background: var(--background-action-high-success);
  color: white;
  border-radius: 0.25rem;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  z-index: 9999;
  animation: slideIn 0.3s ease;
  font-weight: 600;
}

@keyframes slideIn {
  from {
    transform: translateY(100px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

/* --- THÈME SOMBRE AVEC DSFR --- */
[data-fr-scheme="dark"] .dsfr-toolbar {
  background: var(--background-contrast-grey);
  border-color: var(--border-plain-grey);
}

[data-fr-scheme="dark"] .toolbar-header {
  border-color: var(--border-plain-grey);
}

[data-fr-scheme="dark"] .toolbar-dropdown {
  background: var(--background-contrast-grey);
  border-color: var(--border-plain-grey);
}

[data-fr-scheme="dark"] .editor-panel,
[data-fr-scheme="dark"] .preview-panel {
  background: var(--background-contrast-grey);
  border-color: var(--border-plain-grey);
}

[data-fr-scheme="dark"] #markdown-input {
  background: var(--background-contrast-grey);
  color: var(--text-default-grey);
}

[data-fr-scheme="dark"] .panel-header {
  background: var(--background-alt-grey);
  border-color: var(--border-plain-grey);
}

[data-fr-scheme="dark"] .action-bar {
  background: var(--background-contrast-grey);
  border-color: var(--border-plain-grey);
}

[data-fr-scheme="dark"] .button-grid button {
  background: var(--background-alt-grey);
  border-color: var(--border-plain-grey);
  color: var(--text-default-grey);
}

[data-fr-scheme="dark"] .button-grid button:hover {
  background: var(--background-alt-blue-france);
}

/* --- RESPONSIVE --- */
@media (max-width: 1200px) {
  .fr-container {
    padding-left: 3rem !important;
    padding-right: 3rem !important;
  }
}

@media (max-width: 992px) {
  .editor-container {
    grid-template-columns: 1fr;
  }
  
  .toolbar-row {
    flex-direction: column;
  }
  
  .toolbar-btn {
    width: 100% !important;
    min-width: 0 !important;
  }
}

@media (max-width: 768px) {
  .fr-container {
    padding-left: 1rem !important;
    padding-right: 1rem !important;
  }
  
  .toolbar-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 1rem;
  }
  
  .toolbar-actions {
    width: 100%;
    flex-direction: column;
  }
  
  .mini-btn {
    width: 100%;
  }
}

/* --- COMPOSANTS DSFR DANS LE PREVIEW --- */
#preview .fr-alert {
  margin-bottom: 1rem;
}

/* --- MODE PLEIN ÉCRAN (simplifié et garanti) --- */
body.fullscreen-mode {
  overflow: hidden !important;
}

body.fullscreen-mode .fr-header,
body.fullscreen-mode .fr-footer {
  display: none !important;
}

body.fullscreen-mode main {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  width: 100vw !important;
  height: 100vh !important;
  max-width: 100vw !important;
  padding: 0 !important;
  margin: 0 !important;
  z-index: 9999 !important;
  background: var(--background-default-grey) !important;
  display: flex !important;
  flex-direction: column !important;
}

body.fullscreen-mode .fr-container {
  max-width: 100% !important;
  padding: 0 !important;
  margin: 0 !important;
  height: 100vh !important;
  display: flex !important;
  flex-direction: column !important;
  flex: 1 !important;
}

body.fullscreen-mode .dsfr-toolbar {
  margin: 0 !important;
  border-radius: 0 !important;
  flex-shrink: 0 !important;
  padding: 0 !important;
}

body.fullscreen-mode .toolbar-content {
  padding: 0.5rem 1rem !important;
}

body.fullscreen-mode .toolbar-tabs {
  flex-shrink: 0 !important;
}

body.fullscreen-mode .editor-container {
  flex: 1 !important;
  margin: 0 !important;
  padding: 0 !important;
  max-width: 100% !important;
  overflow: visible !important;
  gap: 0 !important;
  display: grid !important;
  grid-template-columns: 1fr 1fr !important;
  height: 100% !important;
}

body.fullscreen-mode .editor-panel,
body.fullscreen-mode .preview-panel {
  height: 100% !important;
  border-radius: 0 !important;
  border-left: none !important;
  border-right: none !important;
  display: flex !important;
  flex-direction: column !important;
}

body.fullscreen-mode .panel-header {
  flex-shrink: 0 !important;
}

body.fullscreen-mode #markdown-input,
body.fullscreen-mode #preview {
  flex: 1 !important;
  width: 100% !important;
  height: 100% !important;
  min-height: 0 !important;
  overflow-y: auto !important;
  display: block !important;
}

body.fullscreen-mode .action-bar {
  flex-shrink: 0 !important;
  border-radius: 0 !important;
  padding: 0.75rem 1rem !important;
  position: relative !important;
  display: flex !important;
  justify-content: center !important;
  gap: 1rem !important;
  background: var(--background-action-low-blue-france) !important;
  border-top: 2px solid var(--blue-marine) !important;
}

[data-fr-scheme="dark"] body.fullscreen-mode {
  background: var(--background-default-grey) !important;
}

[data-fr-scheme="dark"] body.fullscreen-mode main {
  background: var(--background-default-grey) !important;
}

#preview .fr-callout {
  margin-bottom: 1rem;
}

#preview .fr-badge {
  margin-right: 0.5rem;
  margin-bottom: 0.5rem;
}

#preview .fr-card {
  margin-bottom: 1rem;
}

#preview h1, #preview h2, #preview h3 {
  margin-top: 1.5rem;
  margin-bottom: 0.75rem;
}

#preview p {
  margin-bottom: 1rem;
}

#preview ul, #preview ol {
  margin-bottom: 1rem;
  padding-left: 2rem;
}

/* --- TRANSITIONS --- */
* {
  transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
}

button, .fr-btn {
  transition: all 0.2s ease !important;
}
